using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using MySql.Data.MySqlClient;
using System.Windows.Forms;
using System.Net;
using System.Net.Mail;
using System.Net.Mime;

namespace prj_Hemolab.Classes
{
    public class clsDadosGerais
    {
        public static MySqlConnection conexao { get; set; }

        public static string nm_usuario { get; set; }

        public static string cd_usuario { get; set; }

        public static string cd_tipo_usuario { get; set; }

        public static bool troca_usuario { get; set; }

        public static string cd_rg_doador { get; set; }

        public static string nm_doador { get; set; }

        public static string nm_email_doador { get; set; }

        public static string sg_sexo_doador { get; set; }

        public static string cd_triagem { get; set; }

        public static string cd_bolsa_coletada { get; set; }

        public static string dt_coleta { get; set; }

        public static string cd_bolsa_fracionada { get; set; }

        public static string nm_tipo_fracionamento { get; set; }

        public static string cd_ocorrencia { get; set; }

        public static string data_hoje()
        {
            string dia, mes, ano;
            string data = DateTime.Now.ToString().Substring(0, 10);
            data = data.Replace("/", "");
            dia = data.Substring(0, 2);
            mes = data.Substring(2, 2);
            ano = data.Substring(4, 4);
            data = ano + "-" + mes + "-" + dia;
            return data;
        }

        public static string hora_atual()
        {
            string hora = DateTime.Now.ToString().Substring(11, 8);
            return hora;
        }

        public static DataGridView tabela_distribuicao { get; set; }

        public static Button btnVoltar { get; set; }

        #region Funcionário

        public static string cd_funcionario { get; set; }

        public static string cd_cpf_funcionario { get; set; }

        public static string nm_funcionario { get; set; }

        public static string cd_senha_funcionario { get; set; }

        public static string nm_tipo_funcionario { get; set; }

        #endregion

        #region Função "getEmbeddedImage" que faz as imagens do e-mail funcionarem
        public static AlternateView getEmbeddedImage(String filePath, String filePath2, String filePath3, String filePath4, String filePath5)
        {
            LinkedResource inline = new LinkedResource(filePath);
            inline.ContentId = Guid.NewGuid().ToString();
            LinkedResource inline2 = new LinkedResource(filePath2);
            inline2.ContentId = Guid.NewGuid().ToString();
            LinkedResource inline3 = new LinkedResource(filePath3);
            inline3.ContentId = Guid.NewGuid().ToString();
            LinkedResource inline4 = new LinkedResource(filePath4);
            inline4.ContentId = Guid.NewGuid().ToString();
            LinkedResource inline5 = new LinkedResource(filePath5);
            inline5.ContentId = Guid.NewGuid().ToString();
            string htmlBody = "<!DOCTYPE html '-//w3c//dtd xhtml 1.0 transitional //en' 'http://www.w3.org/tr/xhtml1/dtd/xhtml1-transitional.dtd'><html xmlns='http://www.w3.org/1999/xhtml'><head> <!--[if gte mso 9]><xml> <o:OfficeDocumentSettings> <o:AllowPNG/> <o:PixelsPerInch>96</o:PixelsPerInch> </o:OfficeDocumentSettings> </xml><![endif]--> <meta http-equiv='Content-Type' content='text/html; charset=utf-8'> <meta name='viewport' content='width=device-width'> <meta http-equiv='X-UA-Compatible' content='IE=9; IE=8; IE=7; IE=EDGE'> <title>Template Base</title> </head> <body style='width: 100% !important;min-width: 100%;-webkit-text-size-adjust: 100%;-ms-text-size-adjust: 100% !important;margin: 0;padding: 0;background-color: #FFFFFF'> <style id='media-query'> /* Client-specific Styles & Reset */ #outlook a { padding: 0; } /* .ExternalClass applies to Outlook.com (the artist formerly known as Hotmail) */ .ExternalClass { width: 100%; } .ExternalClass, .ExternalClass p, .ExternalClass span, .ExternalClass font, .ExternalClass td, .ExternalClass div { line-height: 100%; } #backgroundTable { margin: 0; padding: 0; width: 100% !important; line-height: 100% !important; } /* Buttons */ .button a { display: inline-block; text-decoration: none; -webkit-text-size-adjust: none; text-align: center; } .button a div { text-align: center !important; } /* Outlook First */ body.outlook p { display: inline !important; } /* Media Queries */ @media only screen and (max-width: 500px) { table[class='body'] img { height: auto !important; width: 100% !important; } table[class='body'] img.fullwidth { max-width: 100% !important; } table[class='body'] center { min-width: 0 !important; } table[class='body'] .container { width: 95% !important; } table[class='body'] .row { width: 100% !important; display: block !important; } table[class='body'] .wrapper { display: block !important; padding-right: 0 !important; } table[class='body'] .columns, table[class='body'] .column { table-layout: fixed !important; float: none !important; width: 100% !important; padding-right: 0px !important; padding-left: 0px !important; display: block !important; } table[class='body'] .wrapper.first .columns, table[class='body'] .wrapper.first .column { display: table !important; } table[class='body'] table.columns td, table[class='body'] table.column td, .col { width: 100% !important; } table[class='body'] table.columns td.expander { width: 1px !important; } table[class='body'] .right-text-pad, table[class='body'] .text-pad-right { padding-left: 10px !important; } table[class='body'] .left-text-pad, table[class='body'] .text-pad-left { padding-right: 10px !important; } table[class='body'] .hide-for-small, table[class='body'] .show-for-desktop { display: none !important; } table[class='body'] .show-for-small, table[class='body'] .hide-for-desktop { display: inherit !important; } .mixed-two-up .col { width: 100% !important; } } @media screen and (max-width: 500px) { div[class='col'] { width: 100% !important; } } @media screen and (min-width: 501px) { table[class='container'] { width: 500px !important; } } </style> <table class='body' style='border-spacing: 0;border-collapse: collapse;vertical-align: top;height: 100%;width: 100%;table-layout: fixed' cellpadding='0' cellspacing='0' width='100%' border='0'> <tbody><tr style='vertical-align: top'> <td class='center' style='word-break: break-word;border-collapse: collapse !important;vertical-align: top;text-align: center;background-color: #FFFFFF' align='center' valign='top'> <table style='border-spacing: 0;border-collapse: collapse;vertical-align: top;background-color: #FFFFFF' cellpadding='0' cellspacing='0' align='center' width='100%' border='0'> <tbody><tr style='vertical-align: top'> <td style='word-break: break-word;border-collapse: collapse !important;vertical-align: top' width='100%'> <!--[if gte mso 9]> <table id='outlookholder' border='0' cellspacing='0' cellpadding='0' align='center'><tr><td> <![endif]--> <!--[if (IE)]> <table width='500' align='center' cellpadding='0' cellspacing='0' border='0'> <tr> <td> <![endif]--> <table class='container' style='border-spacing: 0;border-collapse: collapse;vertical-align: top;max-width: 500px;margin: 0 auto;text-align: inherit' cellpadding='0' cellspacing='0' align='center' width='100%' border='0'><tbody><tr style='vertical-align: top'><td style='word-break: break-word;border-collapse: collapse !important;vertical-align: top' width='100%'><table class='block-grid' style='border-spacing: 0;border-collapse: collapse;vertical-align: top;width: 100%;max-width: 500px;color: #000000;background-color: transparent' cellpadding='0' cellspacing='0' width='100%' bgcolor='transparent'><tbody><tr style='vertical-align: top'><td style='word-break: break-word;border-collapse: collapse !important;vertical-align: top;text-align: center;font-size: 0'><!--[if (gte mso 9)|(IE)]><table width='100%' align='center' bgcolor='transparent' cellpadding='0' cellspacing='0' border='0'><tr><![endif]--><!--[if (gte mso 9)|(IE)]><td valign='top' width='500'><![endif]--><div class='col num12' style='display: inline-block;vertical-align: top;width: 100%'><table style='border-spacing: 0;border-collapse: collapse;vertical-align: top' cellpadding='0' cellspacing='0' align='center' width='100%' border='0'><tbody><tr style='vertical-align: top'><td style='word-break: break-word;border-collapse: collapse !important;vertical-align: top;background-color: transparent;padding-top: 10px;padding-right: 10px;padding-bottom: 10px;padding-left: 10px;border-top: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;border-left: 0px solid transparent'><table style='border-spacing: 0;border-collapse: collapse;vertical-align: top' cellpadding='0' cellspacing='0' width='100%' border='0'> <tbody><tr style='vertical-align: top'> <td style='word-break: break-word;border-collapse: collapse !important;vertical-align: top;width: 100%;padding-top: 0px;padding-right: 0px;padding-bottom: 0px;padding-left: 0px' align='center'> <div style='font-size:12px' align='center'> <a href='https://beefree.io' target='_blank'> <img class='center fullwidth' style='outline: none;text-decoration: none;-ms-interpolation-mode: bicubic;clear: both;display: block;border: none;height: auto;line-height: 100%;margin: 0 auto;float: none;width: 100% !important;max-width: 480px' align='center' border='0' src='cid:" + inline.ContentId + "' alt='Image' title='Image' width='480'> </a> </div> </td> </tr> </tbody></table> </td></tr></tbody></table></div><!--[if (gte mso 9)|(IE)]></td><![endif]--><!--[if (gte mso 9)|(IE)]></td></tr></table><![endif]--></td></tr></tbody></table></td></tr></tbody></table> <!--[if mso]> </td></tr></table> <![endif]--> <!--[if (IE)]> </td></tr></table> <![endif]--> </td> </tr> </tbody></table> <table style='border-spacing: 0;border-collapse: collapse;vertical-align: top;background-color: transparent' cellpadding='0' cellspacing='0' align='center' width='100%' border='0'> <tbody><tr style='vertical-align: top'> <td style='word-break: break-word;border-collapse: collapse !important;vertical-align: top' width='100%'> <!--[if gte mso 9]> <table id='outlookholder' border='0' cellspacing='0' cellpadding='0' align='center'><tr><td> <![endif]--> <!--[if (IE)]> <table width='500' align='center' cellpadding='0' cellspacing='0' border='0'> <tr> <td> <![endif]--> <table class='container' style='border-spacing: 0;border-collapse: collapse;vertical-align: top;max-width: 500px;margin: 0 auto;text-align: inherit' cellpadding='0' cellspacing='0' align='center' width='100%' border='0'><tbody><tr style='vertical-align: top'><td style='word-break: break-word;border-collapse: collapse !important;vertical-align: top' width='100%'><table class='block-grid' style='border-spacing: 0;border-collapse: collapse;vertical-align: top;width: 100%;max-width: 500px;color: #333;background-color: transparent' cellpadding='0' cellspacing='0' width='100%' bgcolor='transparent'><tbody><tr style='vertical-align: top'><td style='word-break: break-word;border-collapse: collapse !important;vertical-align: top;text-align: center;font-size: 0'><!--[if (gte mso 9)|(IE)]><table width='100%' align='center' bgcolor='transparent' cellpadding='0' cellspacing='0' border='0'><tr><![endif]--><!--[if (gte mso 9)|(IE)]><td valign='top' width='500'><![endif]--><div class='col num12' style='display: inline-block;vertical-align: top;width: 100%'><table style='border-spacing: 0;border-collapse: collapse;vertical-align: top' cellpadding='0' cellspacing='0' align='center' width='100%' border='0'><tbody><tr style='vertical-align: top'><td style='word-break: break-word;border-collapse: collapse !important;vertical-align: top;background-color: transparent;padding-top: 30px;padding-right: 0px;padding-bottom: 30px;padding-left: 0px;border-top: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;border-left: 0px solid transparent'><table style='border-spacing: 0;border-collapse: collapse;vertical-align: top' cellpadding='0' cellspacing='0' width='100%'> <tbody><tr style='vertical-align: top'> <td style='word-break: break-word;border-collapse: collapse !important;vertical-align: top;padding-top: 10px;padding-right: 10px;padding-bottom: 0px;padding-left: 10px'> <div style='color:#555555;line-height:120%;font-family:Arial, 'Helvetica Neue', Helvetica, sans-serif;'> <div style='font-size:12px;line-height:14px;color:#555555;font-family:Arial, 'Helvetica Neue', Helvetica, sans-serif;text-align:left;'><p style='margin: 0;font-size: 14px;line-height: 17px'><span style='font-size: 24px; line-height: 28px;'><strong><span style='line-height: 28px; font-size: 24px;'>Ol&#225; " + clsDadosGerais.nm_doador + ",</span></strong></span></p><p style='margin: 0;font-size: 14px;line-height: 16px'>&nbsp;<br></p></div> </div> </td> </tr> </tbody></table> <table style='border-spacing: 0;border-collapse: collapse;vertical-align: top' cellpadding='0' cellspacing='0' width='100%'> <tbody><tr style='vertical-align: top'> <td style='word-break: break-word;border-collapse: collapse !important;vertical-align: top;padding-top: 5px;padding-right: 10px;padding-bottom: 5px;padding-left: 10px'> <div style='color:#777777;line-height:120%;font-family:Arial, 'Helvetica Neue', Helvetica, sans-serif;'> <div style='font-size:12px;line-height:14px;color:#777777;font-family:Arial, 'Helvetica Neue', Helvetica, sans-serif;text-align:left;'><p style='margin: 0;font-size: 12px;line-height: 14px'><span style='font-size: 20px; line-height: 24px;'>Notamos que voc&#234; doou sangue em nosso Hemocentro j&#225; fazem mais de " + clsDadosGerais.sg_sexo_doador + " meses. Gostar&#237;amos apenas de lembr&#225;-lo que voc&#234; j&#225; pode doar novamente!</span></p><p style='margin: 0;font-size: 12px;line-height: 14px'>&nbsp;<br></p><p style='margin: 0;font-size: 12px;line-height: 14px'><span style='font-size: 20px; line-height: 24px;'>Atenciosamente, Equipe do Hemolab.</span></p></div> </div> </td> </tr> </tbody></table> </td></tr></tbody></table></div><!--[if (gte mso 9)|(IE)]></td><![endif]--><!--[if (gte mso 9)|(IE)]></td></tr></table><![endif]--></td></tr></tbody></table></td></tr></tbody></table> <!--[if mso]> </td></tr></table> <![endif]--> <!--[if (IE)]> </td></tr></table> <![endif]--> </td> </tr> </tbody></table> <table style='border-spacing: 0;border-collapse: collapse;vertical-align: top;background-color: #444444' cellpadding='0' cellspacing='0' align='center' width='100%' border='0'> <tbody><tr style='vertical-align: top'> <td style='word-break: break-word;border-collapse: collapse !important;vertical-align: top' width='100%'> <!--[if gte mso 9]> <table id='outlookholder' border='0' cellspacing='0' cellpadding='0' align='center'><tr><td> <![endif]--> <!--[if (IE)]> <table width='500' align='center' cellpadding='0' cellspacing='0' border='0'> <tr> <td> <![endif]--> <table class='container' style='border-spacing: 0;border-collapse: collapse;vertical-align: top;max-width: 500px;margin: 0 auto;text-align: inherit' cellpadding='0' cellspacing='0' align='center' width='100%' border='0'><tbody><tr style='vertical-align: top'><td style='word-break: break-word;border-collapse: collapse !important;vertical-align: top' width='100%'><table class='block-grid' style='border-spacing: 0;border-collapse: collapse;vertical-align: top;width: 100%;max-width: 500px;color: #333;background-color: transparent' cellpadding='0' cellspacing='0' width='100%' bgcolor='transparent'><tbody><tr style='vertical-align: top'><td style='word-break: break-word;border-collapse: collapse !important;vertical-align: top;text-align: center;font-size: 0'><!--[if (gte mso 9)|(IE)]><table width='100%' align='center' bgcolor='transparent' cellpadding='0' cellspacing='0' border='0'><tr><![endif]--><!--[if (gte mso 9)|(IE)]><td valign='top' width='500'><![endif]--><div class='col num12' style='display: inline-block;vertical-align: top;width: 100%'><table style='border-spacing: 0;border-collapse: collapse;vertical-align: top' cellpadding='0' cellspacing='0' align='center' width='100%' border='0'><tbody><tr style='vertical-align: top'><td style='word-break: break-word;border-collapse: collapse !important;vertical-align: top;background-color: transparent;padding-top: 25px;padding-right: 0px;padding-bottom: 25px;padding-left: 0px;border-top: 0px solid transparent;border-right: 0px solid transparent;border-bottom: 0px solid transparent;border-left: 0px solid transparent'> <table style='border-spacing: 0;border-collapse: collapse;vertical-align: top' width='100%' border='0' cellspacing='0' cellpadding='0'> <tbody><tr style='vertical-align: top'> <td style='word-break: break-word;border-collapse: collapse !important;vertical-align: top' align='center' valign='top'> <table style='border-spacing: 0;border-collapse: collapse;vertical-align: top' border='0' cellspacing='0' cellpadding='0'> <tbody><tr style='vertical-align: top'> <td style='word-break: break-word;border-collapse: collapse !important;vertical-align: top;text-align: center;padding-top: 10px;padding-right: 10px;padding-bottom: 10px;padding-left: 10px;max-width: 193px' align='center' valign='top'> <!--[if (gte mso 9)|(IE)]> <table width='203' align='left' border='0' cellspacing='0' cellpadding='0'> <tr> <td align='left'> <![endif]--> <table style='border-spacing: 0;border-collapse: collapse;vertical-align: top' width='100%' align='left' cellpadding='0' cellspacing='0' border='0'> <tbody><tr style='vertical-align: top'> <td style='word-break: break-word;border-collapse: collapse !important;vertical-align: top' align='left' valign='middle'> <table style='border-spacing: 0;border-collapse: collapse;vertical-align: top;padding: 0 5px 5px 0' align='left' border='0' cellspacing='0' cellpadding='0' height='37'> <tbody><tr style='vertical-align: top'> <td style='word-break: break-word;border-collapse: collapse !important;vertical-align: top' width='37' align='left' valign='middle'> <a href='https://www.facebook.com/loose.yourself.to.bass' title='Facebook' target='_blank'> <img style='outline: none;text-decoration: none;-ms-interpolation-mode: bicubic;clear: both;display: block;border: none;height: auto;line-height: 100%;max-width: 32px !important' src='cid:" + inline2.ContentId + "' alt='Facebook' title='Facebook' width='32'> </a> </td> </tr> </tbody></table> <table style='border-spacing: 0;border-collapse: collapse;vertical-align: top;padding: 0 5px 5px 0' align='left' border='0' cellspacing='0' cellpadding='0' height='37'> <tbody><tr style='vertical-align: top'> <td style='word-break: break-word;border-collapse: collapse !important;vertical-align: top' width='37' align='left' valign='middle'> <a href='http://twitter.com/' title='Twitter' target='_blank'> <img style='outline: none;text-decoration: none;-ms-interpolation-mode: bicubic;clear: both;display: block;border: none;height: auto;line-height: 100%;max-width: 32px !important' src='cid:" + inline3.ContentId + "' alt='Twitter' title='Twitter' width='32'> </a> </td> </tr> </tbody></table> <table style='border-spacing: 0;border-collapse: collapse;vertical-align: top;padding: 0 5px 5px 0' align='left' border='0' cellspacing='0' cellpadding='0' height='37'> <tbody><tr style='vertical-align: top'> <td style='word-break: break-word;border-collapse: collapse !important;vertical-align: top' width='37' align='left' valign='middle'> <a href='https://www.youtube.com/channel/UCfkLy92cxTBVAfH0Y449_Uw' title='YouTube' target='_blank'> <img style='outline: none;text-decoration: none;-ms-interpolation-mode: bicubic;clear: both;display: block;border: none;height: auto;line-height: 100%;max-width: 32px !important' src='cid:" + inline4.ContentId + "' alt='YouTube' title='YouTube' width='32'> </a> </td> </tr> </tbody></table> <table style='border-spacing: 0;border-collapse: collapse;vertical-align: top;padding: 0 5px 5px 0' align='left' border='0' cellspacing='0' cellpadding='0' height='37'> <tbody><tr style='vertical-align: top'> <td style='word-break: break-word;border-collapse: collapse !important;vertical-align: top' width='37' align='left' valign='middle'> <a href='https://www.instagram.com/liammaricato/' title='Instagram' target='_blank'> <img style='outline: none;text-decoration: none;-ms-interpolation-mode: bicubic;clear: both;display: block;border: none;height: auto;line-height: 100%;max-width: 32px !important' src='cid:" + inline5.ContentId + "' alt='Instagram' title='Instagram' width='32'> </a> </td> </tr> </tbody></table> </td> </tr> </tbody></table> <!--[if (gte mso 9)|(IE)]> </td> </tr> </table> <![endif]--> </td> </tr> </tbody></table> </td> </tr> </tbody></table><table style='border-spacing: 0;border-collapse: collapse;vertical-align: top' cellpadding='0' cellspacing='0' width='100%'> <tbody><tr style='vertical-align: top'> <td style='word-break: break-word;border-collapse: collapse !important;vertical-align: top;padding-top: 10px;padding-right: 10px;padding-bottom: 10px;padding-left: 10px'> <div style='color:#bbbbbb;line-height:120%;font-family:Arial, 'Helvetica Neue', Helvetica, sans-serif;'> <div style='font-size:12px;line-height:14px;color:#bbbbbb;font-family:Arial, 'Helvetica Neue', Helvetica, sans-serif;text-align:left;'><p style='margin: 0;font-size: 12px;line-height: 14px'>&nbsp;<br></p><p style='margin: 0;font-size: 12px;line-height: 14px;text-align: center'>&nbsp;&#169; 2016 Hemolab - All rights reserved.<br></p></div> </div> </td> </tr> </tbody></table> </td></tr></tbody></table></div><!--[if (gte mso 9)|(IE)]></td><![endif]--><!--[if (gte mso 9)|(IE)]></td></tr></table><![endif]--></td></tr></tbody></table></td></tr></tbody></table> <!--[if mso]> </td></tr></table> <![endif]--> <!--[if (IE)]> </td></tr></table> <![endif]--> </td> </tr> </tbody></table> </td> </tr> </tbody></table> </body></html>";
            //@"<img src='cid:" + inline.ContentId + @"'/>";
            AlternateView alternateView = AlternateView.CreateAlternateViewFromString(htmlBody, null, MediaTypeNames.Text.Html);
            alternateView.LinkedResources.Add(inline);
            alternateView.LinkedResources.Add(inline2);
            alternateView.LinkedResources.Add(inline3);
            alternateView.LinkedResources.Add(inline4);
            alternateView.LinkedResources.Add(inline5);
            return alternateView;
        }
        #endregion
    }
}
